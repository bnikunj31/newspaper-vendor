<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Add User Form</title>
    <link rel="stylesheet" href="/styles.css" />
    <link
      rel="stylesheet"
      href="/node_modules/bootstrap/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="/node_modules/select2/dist/css/select2.min.css"
    />
    <!-- Select2 CSS -->
  </head>
  <body>
    <!-- Navbar -->
    <%- include('../navbar.html') %>

    <div class="container my-5 rounded bg-light p-4">
      <h2>Generate Transactions</h2>
      <form method="post" action="/transactions/generate" id="transactionForm">
        <!-- Colony (Dropdown with search) -->
        <div class="mb-3">
          <label for="colony" class="form-label">Colony</label>
          <select
            class="form-select select2"
            id="colony"
            name="colony"
            required
          >
            <option selected disabled>Select colony</option>
            <% data.forEach(function(colony) { %>
            <option value="<%= colony.colonyCode %>">
              <%= colony.colonyName %> (<%= colony.colonyCode %>)
            </option>
            <% }) %>
          </select>
        </div>

        <!-- Date Input Field -->
        <div class="mb-3">
          <label for="date" class="form-label">Transaction Date</label>
          <input
            type="date"
            class="form-control"
            id="date"
            name="date"
            required
          />
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn btn-primary">
          Generate Transactions
        </button>
      </form>
    </div>

    <script src="/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="/node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/node_modules/select2/dist/js/select2.min.js"></script>
    <script>
      $(document).ready(function () {
        $(".select2").select2();

        // Format date before form submission
        $("#transactionForm").on("submit", function (e) {
          const dateInput = $("#date");
          const dateValue = dateInput.val();

          // Validate if the date is in the right format
          const datePattern = /^\d{4}-\d{2}-\d{2}$/; // Matches yyyy-mm-dd
          if (!datePattern.test(dateValue)) {
            e.preventDefault(); // Prevent form submission
            alert("Please enter a valid date in the format YYYY-MM-DD.");
          }
        });
      });
    </script>
  </body>
</html>
